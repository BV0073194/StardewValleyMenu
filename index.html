<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B's Stardew Valley Modding Menu</title>
    <link rel="stylesheet" href="./style.css">
<body>

<div class="container">
    <h1>Stardew Valley Item Spawner</h1>

    <div class="spawn-form">
        <label for="quantity">Quantity:</label>
        <input type="number" id="quantity" name="quantity" value="1" min="1">
    </div>

    <!-- Filter Options -->
    <div class="filters">
        <select id="category-filter">
            <option value="all">All Categories</option>
            <option value="Tool">Tool</option>
            <option value="Item">Item</option>
        </select>

        <select id="rarity-filter">
            <option value="all">All Rarities</option>
            <option value="None">None</option>
            <option value="Common">Common</option>
            <option value="Uncommon">Uncommon</option>
            <option value="Rare">Rare</option>
            <option value="Legendary">Legendary</option>
            <option value="Mythic">Mythic</option>
        </select>
    </div>

    <!-- Item List -->
    <div class="item-list" id="item-list">
        <div class="item-card" data-category="Tool" data-subcategory="Item" data-rarity="None" data-id="101">
            <img src="https://stardewvalleywiki.com/mediawiki/images/d/d1/Arrowhead.png" alt="Arrowhead">
            <p>Arrowhead</p>
        </div>
    </div>
</div>

<script>
async function fetchItemList() {
    try {
        const response = await fetch('https://raw.githubusercontent.com/BV0073194/StardewValleyMenu/refs/heads/main/index.html');
        if (response.ok) {
            const html = await response.text();
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            const newItemList = doc.getElementById('item-list');
            
            if (newItemList) {
                document.getElementById('item-list').innerHTML = newItemList.innerHTML;
                filterItems();  // Reapply filters on update
                attachItemClickEvents();  // Reattach event listeners
            }
        } else {
            console.error('Failed to load HTML:', response.statusText);
        }
    } catch (error) {
        console.error('Error fetching HTML:', error);
    }
}

// Reattach item click events dynamically
function attachItemClickEvents() {
    document.querySelectorAll('.item-card').forEach(card => {
        card.addEventListener('click', () => {
            const itemId = card.dataset.id;
            const quantity = document.getElementById('quantity').value;
            window.location.href = `/?item=${itemId}&quantity=${quantity}`;
        });
    });
}

// Filtering logic
const categoryFilter = document.getElementById('category-filter');
const rarityFilter = document.getElementById('rarity-filter');

function filterItems() {
    const selectedCategory = categoryFilter.value;
    const selectedRarity = rarityFilter.value;

    document.querySelectorAll('.item-card').forEach(card => {
        const matchesCategory = selectedCategory === 'all' || card.dataset.category === selectedCategory;
        const matchesRarity = selectedRarity === 'all' || card.dataset.rarity === selectedRarity;

        card.style.display = (matchesCategory && matchesRarity) ? 'block' : 'none';
    });
}

// Filter event listeners
categoryFilter.addEventListener('change', filterItems);
rarityFilter.addEventListener('change', filterItems);

// Refresh item list every 5 seconds
setInterval(fetchItemList, 5000);
fetchItemList();
</script>



</body></html>
